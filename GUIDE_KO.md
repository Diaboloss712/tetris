# 테트리스 멀티플레이어 - 한글 가이드

## 🎮 게임 특징

### 공격/방어 시스템 (jstris 스타일)

이 게임은 **tetris.io**와 **jstris** 같은 현대적인 테트리스 배틀 시스템을 구현했습니다!

#### 🔥 공격 시스템

라인을 제거하면 상대에게 **쓰레기 라인**을 보냅니다:

- **1줄 제거**: 공격 없음 (하지만 콤보는 유지!)
- **2줄 제거**: 1줄 공격
- **3줄 제거**: 2줄 공격
- **4줄 제거 (테트리스)**: 4줄 공격

#### 💥 콤보 시스템

연속으로 라인을 제거하면 **콤보**가 쌓입니다:
- 콤보가 높을수록 추가 공격 라인이 늘어남
- 콤보 2x: +1줄
- 콤보 3x: +2줄
- 콤보 4x: +3줄
- 최대 콤보 보너스: +10줄

**예시**: 
- 2줄 제거 (기본 1줄) + 콤보 5x (+4줄) = **총 5줄 공격!**

#### 🎯 Back-to-Back (B2B) 보너스

테트리스(4줄)를 연속으로 성공하면:
- B2B 보너스 +1줄 추가
- B2B가 쌓일수록 추가 보너스

#### 🛡️ 방어 시스템

공격을 받으면:
1. **받을 예정 쓰레기**: 화면에 빨간색으로 표시
2. **상쇄 가능**: 블록을 놓기 전에 라인을 지우면 쓰레기를 상쇄
   - 1줄 지우면 쓰레기 1줄 상쇄
   - 4줄 지우면 쓰레기 4줄 상쇄하고 남은 줄로 역공격!

3. **쓰레기 추가**: 블록이 고정되면 쓰레기 라인이 맨 아래 추가됨
   - 각 줄마다 랜덤한 위치에 한 칸 빔

---

## 🏠 같은 공유기에서 플레이하기

### 방법 1: 자동 연결 (가장 쉬움)

1. **호스트 컴퓨터**에서 서버 시작:
   ```bash
   cd server
   uvicorn main:app --host 0.0.0.0 --port 8000
   ```

2. **모든 플레이어** (호스트 포함)가 로비 실행:
   ```bash
   cd client
   python lobby.py
   ```

3. 로비 메인 화면에서 **"내 로컬 IP"**를 확인 (예: `192.168.0.10:8000`)

4. **다른 컴퓨터**에서 로비 실행 시 호스트 IP 사용:
   ```bash
   python lobby.py ws://192.168.0.10:8000
   ```

### 방법 2: 수동 IP 찾기

**Windows**:
```bash
ipconfig
```
- "IPv4 주소" 찾기 (예: 192.168.0.10)

**Mac/Linux**:
```bash
ifconfig
```
또는
```bash
ip addr show
```

그 다음 위 IP로 접속:
```bash
python lobby.py ws://찾은IP주소:8000
```

---

## 🎮 게임 조작법

### 기본 조작
- **←/→ 방향키**: 블록 좌우 이동
- **↓ 방향키**: 소프트 드롭 (빠르게 내리기)
- **↑ 방향키**: 블록 회전
- **스페이스바**: 하드 드롭 (즉시 떨어뜨리기)
- **R**: 게임 오버 후 재시작

### 전략 팁

1. **콤보 유지하기**
   - 1줄씩이라도 계속 지워서 콤보 유지
   - 콤보가 끊기면 처음부터 다시 시작

2. **테트리스 노리기**
   - I 블록을 위해 한쪽에 공간 만들기
   - 4줄을 한번에 지우면 강력한 공격

3. **쓰레기 상쇄**
   - 받을 공격이 보이면 빨리 라인 지우기
   - 상쇄하고 남은 라인으로 역공격 가능

4. **방어 타이밍**
   - 블록이 고정되기 전까지는 쓰레기가 안 옴
   - 블록을 놓는 순간 쓰레기 추가됨

---

## 📊 화면 정보

### 오른쪽 사이드바

- **Next**: 다음에 올 블록
- **점수**: 현재 점수
- **레벨**: 현재 레벨 (속도 증가)
- **라인**: 제거한 총 라인 수
- **콤보**: 현재 콤보 (노란색, 2 이상일 때 표시)
- **B2B**: Back-to-Back 카운트 (파란색)
- **받을 공격**: 곧 추가될 쓰레기 라인 (빨간색)
- **공격/받음**: 보낸/받은 총 공격 통계

---

## 🏆 로비 시스템

### 방 만들기
1. 메인 메뉴에서 "방 만들기" 클릭
2. 방 이름 입력
3. 생성하면 자동으로 호스트가 됨

### 방 참가하기
1. 메인 메뉴에서 "방 참가" 클릭
2. 사용 가능한 방 목록 확인
3. 원하는 방 클릭해서 입장

### 게임 시작
1. 모든 플레이어가 "준비" 버튼 클릭
2. 전원이 준비하면 자동으로 게임 시작
3. 호스트는 수동으로 시작 가능

---

## 🌐 인터넷으로 플레이하기 (다른 공유기 사용자)

### ngrok 사용 (무료, 가장 쉬움)

1. [ngrok 다운로드](https://ngrok.com/download)

2. 서버 시작:
   ```bash
   cd server
   uvicorn main:app --host 0.0.0.0 --port 8000
   ```

3. 새 터미널에서 ngrok 실행:
   ```bash
   ngrok http 8000
   ```

4. ngrok URL 복사 (예: `https://abc123.ngrok.io`)

5. 모든 플레이어가 접속:
   ```bash
   python lobby.py wss://abc123.ngrok.io
   ```

### AWS/DigitalOcean 사용

자세한 내용은 [DEPLOYMENT.md](DEPLOYMENT.md) 참조

---

## 🎯 게임 모드

### 배틀 로얄 (Battle Royale)
- 최대 4명이 한 방에서 플레이
- 라인을 지우면 다른 모든 플레이어에게 공격
- 마지막까지 살아남는 사람이 승리

### 연습 모드
- 서버 연결 없이 혼자 연습
- 공격/방어 시스템은 작동하지 않음

---

## 🐛 문제 해결

### "서버 연결 실패"
- 서버가 실행 중인지 확인
- 방화벽이 8000번 포트를 막고 있는지 확인
- Windows Defender 방화벽에서 Python 허용

### "방이 안 보여요"
- "새로고침" 버튼 클릭
- 연결 상태 확인 (초록색 "연결됨" 표시)

### "공격이 안 가요"
- 1줄 제거는 공격이 없음 (콤보만 증가)
- 2줄 이상 제거해야 공격 발생
- 서버 연결 확인

### "쓰레기가 너무 많아요"
- 라인을 빨리 지워서 상쇄하기
- 테트리스(4줄)로 강력하게 역공격
- 콤보를 유지해서 지속적으로 공격

---

## 📈 점수 계산

- 1줄 제거: 100점 × 레벨
- 2줄 제거: 300점 × 레벨
- 3줄 제거: 500점 × 레벨  
- 4줄 제거: 800점 × 레벨
- 공격 보너스: +50점 × 공격 라인 수

---

## 🎨 블록 색상

- **I (하늘색)**: 일직선 4칸 - 테트리스용!
- **O (노란색)**: 정사각형
- **T (마젠타)**: T자 모양
- **L (주황색)**: L자 모양
- **J (파란색)**: 역 L자
- **S (초록색)**: Z자
- **Z (빨간색)**: 역 Z자
- **쓰레기 (회색)**: 공격 받은 라인

---

## 💡 고급 전략

### 다운스태킹 (Downstacking)
- 쓰레기를 빨리 처리하는 기술
- 구멍 주변부터 정리
- 연속 라인 제거로 콤보 유지

### 4-Wide
- 4칸 너비의 빈 공간 만들기
- 지속적인 콤보 가능
- 고수 전략

### T-Spin (향후 추가 예정)
- T 블록을 회전시켜 끼워 넣기
- 강력한 공격 보너스

---

즐거운 게임 되세요! 🎮✨
